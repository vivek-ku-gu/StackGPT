<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StackGPT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Welcome to StackGPT</h1>
            <p>Your AI-powered assistant for code generation and more.</p>
        </header>

        <form action="/generate" method="post" id="promptForm">
            <div class="input-group">
                <textarea name="prompt" id="promptInput" rows="4" placeholder="Enter your prompt here..."></textarea>
            </div>
            <div class="buttons">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-paper-plane"></i> Generate Response
                </button>
                <a href="/search" class="btn-secondary">
                    <i class="fas fa-search"></i> Search in Thread
                </a>
            </div>
        </form>

        {% if prompt %}
        <div class="card prompt-frame">
            <strong>Prompt:</strong>
            <div class="markdown-content">{{ prompt | safe }}</div>
        </div>
        {% endif %}

        {% if response_text %}
        <div class="card response-frame">
            <strong>Response:</strong>
            <div class="markdown-content scrollable-response">{{ response_text | safe }}</div>
        </div>

        <form action="/create_thread" method="post">
            <input type="hidden" name="response_text" value="{{ response_text }}">
            <button type="submit" class="btn-primary create-thread-btn">
                <i class="fas fa-comments"></i> Create Thread
            </button>
        </form>
        {% endif %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });

        document.getElementById('promptInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                document.getElementById('promptForm').submit();
            }
        });
    </script>
</body>
</html>